BEGIN;
BEGIN
select
	nation,
	o_year,
	sum(amount) as sum_profit
from
	(
		select
			n_name as nation,
			extract(year from o_orderdate) as o_year,
			l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount
		from
			part,
			supplier,
			lineitem,
			partsupp,
			orders,
			nation
		where
			s_suppkey = l_suppkey
			and ps_suppkey = l_suppkey
			and ps_partkey = l_partkey
			and p_partkey = l_partkey
			and o_orderkey = l_orderkey
			and s_nationkey = n_nationkey
			and p_name like '%chiffon%'
	) as profit
group by
	nation,
	o_year
order by
	nation,
	o_year desc;
          nation           | o_year |    sum_profit    
---------------------------+--------+------------------
 ALGERIA                   |   1998 | 271743549.721251
 ALGERIA                   |   1997 | 454909462.286398
 ALGERIA                   |   1996 | 462466771.318163
 ALGERIA                   |   1995 | 460753438.100506
 ALGERIA                   |   1994 | 451921798.773855
 ALGERIA                   |   1993 | 458660453.612502
 ALGERIA                   |   1992 | 454607691.903066
 ARGENTINA                 |   1998 | 269129162.079818
 ARGENTINA                 |   1997 | 472573174.787032
 ARGENTINA                 |   1996 | 467104083.009657
 ARGENTINA                 |   1995 | 462137990.055521
 ARGENTINA                 |   1994 | 474416390.673154
 ARGENTINA                 |   1993 | 466973548.499346
 ARGENTINA                 |   1992 | 462307789.084714
 BRAZIL                    |   1998 | 268349537.315373
 BRAZIL                    |   1997 | 468411558.241845
 BRAZIL                    |   1996 | 461893156.541566
 BRAZIL                    |   1995 | 465434948.059567
 BRAZIL                    |   1994 | 466672481.327864
 BRAZIL                    |   1993 | 456159003.326844
 BRAZIL                    |   1992 | 472019974.636028
 CANADA                    |   1998 | 275361515.445587
 CANADA                    |   1997 | 460586105.117191
 CANADA                    |   1996 | 473419455.047082
 CANADA                    |   1995 | 463653243.973768
 CANADA                    |   1994 | 475134529.248858
 CANADA                    |   1993 | 468668981.031222
 CANADA                    |   1992 | 475049979.711628
 CHINA                     |   1998 | 277443206.038652
 CHINA                     |   1997 | 475564025.721511
 CHINA                     |   1996 | 477896947.336528
 CHINA                     |   1995 | 470969878.227297
 CHINA                     |   1994 | 471099745.299272
 CHINA                     |   1993 | 476367447.430909
 CHINA                     |   1992 | 471948183.887148
 EGYPT                     |   1998 | 272032740.244057
 EGYPT                     |   1997 | 462626371.823525
 EGYPT                     |   1996 | 472582868.179943
 EGYPT                     |   1995 | 466259988.925524
 EGYPT                     |   1994 | 460687377.718904
 EGYPT                     |   1993 |  465339361.65552
 EGYPT                     |   1992 | 461383666.301248
 ETHIOPIA                  |   1998 | 268108313.122229
 ETHIOPIA                  |   1997 | 458590031.435863
 ETHIOPIA                  |   1996 | 454403625.595895
 ETHIOPIA                  |   1995 | 458201419.599522
 ETHIOPIA                  |   1994 | 454719212.023223
 ETHIOPIA                  |   1993 | 459665254.362307
 ETHIOPIA                  |   1992 |  457777817.13205
 FRANCE                    |   1998 | 271651808.107904
 FRANCE                    |   1997 | 469522647.753359
 FRANCE                    |   1996 | 463238795.924567
 FRANCE                    |   1995 | 470307630.530985
 FRANCE                    |   1994 | 464477047.274888
 FRANCE                    |   1993 | 465947673.871299
 FRANCE                    |   1992 | 458116165.996985
 GERMANY                   |   1998 | 278677521.765557
 GERMANY                   |   1997 | 469202921.101932
 GERMANY                   |   1996 | 472453611.677677
 GERMANY                   |   1995 |  475206654.72485
 GERMANY                   |   1994 | 473447414.197878
 GERMANY                   |   1993 | 468597711.363705
 GERMANY                   |   1992 | 470880573.487349
 INDIA                     |   1998 | 277824233.952997
 INDIA                     |   1997 | 471637956.001099
 INDIA                     |   1996 | 477982491.973535
 INDIA                     |   1995 | 470034481.353373
 INDIA                     |   1994 | 473474177.089256
 INDIA                     |   1993 | 471780903.357246
 INDIA                     |   1992 | 479577769.236858
 INDONESIA                 |   1998 | 276230310.176487
 INDONESIA                 |   1997 | 463011915.082541
 INDONESIA                 |   1996 | 469227404.559568
 INDONESIA                 |   1995 | 455923640.422507
 INDONESIA                 |   1994 | 463834843.918437
 INDONESIA                 |   1993 | 466513127.704191
 INDONESIA                 |   1992 | 463827931.600447
 IRAN                      |   1998 | 271824732.749181
 IRAN                      |   1997 | 461628909.856161
 IRAN                      |   1996 | 458656906.539101
 IRAN                      |   1995 | 463097941.088271
 IRAN                      |   1994 | 459311959.100306
 IRAN                      |   1993 |  460584988.93157
 IRAN                      |   1992 | 466038991.775178
 IRAQ                      |   1998 | 276514281.785066
 IRAQ                      |   1997 | 463776331.888686
 IRAQ                      |   1996 | 471870510.323179
 IRAQ                      |   1995 | 470571587.049653
 IRAQ                      |   1994 | 474858436.253584
 IRAQ                      |   1993 | 476196629.211222
 IRAQ                      |   1992 | 472747978.857795
 JAPAN                     |   1998 | 278359001.050639
 JAPAN                     |   1997 | 474451199.286537
 JAPAN                     |   1996 | 470066936.198755
 JAPAN                     |   1995 | 475188502.173211
 JAPAN                     |   1994 | 474069459.905369
 JAPAN                     |   1993 | 472292564.145037
 JAPAN                     |   1992 | 474938355.552731
 JORDAN                    |   1998 | 277138766.068025
 JORDAN                    |   1997 | 462244044.451226
 JORDAN                    |   1996 |  466006249.22368
 JORDAN                    |   1995 | 464208705.677498
 JORDAN                    |   1994 | 462912174.519553
 JORDAN                    |   1993 | 468180160.926696
 JORDAN                    |   1992 | 462698669.797682
 KENYA                     |   1998 | 272844565.549056
 KENYA                     |   1997 | 466609850.101014
 KENYA                     |   1996 |  476248829.41686
 KENYA                     |   1995 | 471963296.955565
 KENYA                     |   1994 | 473130124.320047
 KENYA                     |   1993 |  474452429.44379
 KENYA                     |   1992 | 476072626.298378
 MOROCCO                   |   1998 | 273826475.524923
 MOROCCO                   |   1997 | 467273549.306167
 MOROCCO                   |   1996 | 478125572.870405
 MOROCCO                   |   1995 | 467074541.088001
 MOROCCO                   |   1994 | 477317606.737794
 MOROCCO                   |   1993 |  465243913.84428
 MOROCCO                   |   1992 | 482505650.239329
 MOZAMBIQUE                |   1998 |  269145347.28203
 MOZAMBIQUE                |   1997 | 455793959.860978
 MOZAMBIQUE                |   1996 | 462181666.347046
 MOZAMBIQUE                |   1995 | 457597654.916964
 MOZAMBIQUE                |   1994 | 460255480.318166
 MOZAMBIQUE                |   1993 | 454372815.249901
 MOZAMBIQUE                |   1992 | 456127885.011605
 PERU                      |   1998 | 275527369.649651
 PERU                      |   1997 | 462039013.772012
 PERU                      |   1996 | 465136423.278098
 PERU                      |   1995 | 472394838.360291
 PERU                      |   1994 | 461335683.691344
 PERU                      |   1993 | 470961285.642033
 PERU                      |   1992 | 461729369.893105
 ROMANIA                   |   1998 | 278394239.859159
 ROMANIA                   |   1997 |  461842324.02029
 ROMANIA                   |   1996 | 465651246.779189
 ROMANIA                   |   1995 | 463593089.729683
 ROMANIA                   |   1994 | 469869926.295251
 ROMANIA                   |   1993 | 466523457.698073
 ROMANIA                   |   1992 | 468930276.266226
 RUSSIA                    |   1998 | 273483148.425634
 RUSSIA                    |   1997 | 467964776.572243
 RUSSIA                    |   1996 | 467577909.808096
 RUSSIA                    |   1995 | 470200477.315278
 RUSSIA                    |   1994 | 471512044.563361
 RUSSIA                    |   1993 | 470489948.466699
 RUSSIA                    |   1992 | 470656727.192804
 SAUDI ARABIA              |   1998 |   272600093.7018
 SAUDI ARABIA              |   1997 |  461356123.41227
 SAUDI ARABIA              |   1996 | 465220475.572963
 SAUDI ARABIA              |   1995 | 458228962.490627
 SAUDI ARABIA              |   1994 | 455631448.951193
 SAUDI ARABIA              |   1993 | 461319184.264613
 SAUDI ARABIA              |   1992 | 463308744.181658
 UNITED KINGDOM            |   1998 | 271238970.419629
 UNITED KINGDOM            |   1997 | 458421683.360196
 UNITED KINGDOM            |   1996 | 469978741.620906
 UNITED KINGDOM            |   1995 | 461761168.474023
 UNITED KINGDOM            |   1994 | 458789714.734345
 UNITED KINGDOM            |   1993 | 464405705.213219
 UNITED KINGDOM            |   1992 | 463426887.902575
 UNITED STATES             |   1998 | 269420374.080699
 UNITED STATES             |   1997 | 465444126.218241
 UNITED STATES             |   1996 | 465258340.492007
 UNITED STATES             |   1995 | 462269785.061594
 UNITED STATES             |   1994 | 470100804.032672
 UNITED STATES             |   1993 | 463548032.601153
 UNITED STATES             |   1992 | 469487008.564773
 VIETNAM                   |   1998 | 275270051.685814
 VIETNAM                   |   1997 | 466958322.788249
 VIETNAM                   |   1996 | 466838258.544858
 VIETNAM                   |   1995 | 461959181.042235
 VIETNAM                   |   1994 |  463244214.89269
 VIETNAM                   |   1993 | 470156342.311376
 VIETNAM                   |   1992 | 472667778.403344
(175 rows)

COMMIT;
COMMIT

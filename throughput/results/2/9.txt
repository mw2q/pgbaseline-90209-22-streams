BEGIN;
BEGIN
select
	nation,
	o_year,
	sum(amount) as sum_profit
from
	(
		select
			n_name as nation,
			extract(year from o_orderdate) as o_year,
			l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount
		from
			part,
			supplier,
			lineitem,
			partsupp,
			orders,
			nation
		where
			s_suppkey = l_suppkey
			and ps_suppkey = l_suppkey
			and ps_partkey = l_partkey
			and p_partkey = l_partkey
			and o_orderkey = l_orderkey
			and s_nationkey = n_nationkey
			and p_name like '%indian%'
	) as profit
group by
	nation,
	o_year
order by
	nation,
	o_year desc;
          nation           | o_year |    sum_profit    
---------------------------+--------+------------------
 ALGERIA                   |   1998 | 264370540.077888
 ALGERIA                   |   1997 | 465277373.382248
 ALGERIA                   |   1996 | 456106404.075793
 ALGERIA                   |   1995 | 467922390.473228
 ALGERIA                   |   1994 | 455006428.753475
 ALGERIA                   |   1993 |   463037027.5353
 ALGERIA                   |   1992 | 462885262.189005
 ARGENTINA                 |   1998 | 270777065.723867
 ARGENTINA                 |   1997 |  469627906.66345
 ARGENTINA                 |   1996 |  468803842.92954
 ARGENTINA                 |   1995 | 463868020.759716
 ARGENTINA                 |   1994 | 464905647.518991
 ARGENTINA                 |   1993 |  458473820.07817
 ARGENTINA                 |   1992 | 457073901.390244
 BRAZIL                    |   1998 |  279154848.46451
 BRAZIL                    |   1997 | 465161045.742851
 BRAZIL                    |   1996 | 470171588.475759
 BRAZIL                    |   1995 | 462474669.531541
 BRAZIL                    |   1994 | 466045123.245504
 BRAZIL                    |   1993 | 465290108.376892
 BRAZIL                    |   1992 | 476178553.613051
 CANADA                    |   1998 | 275586850.214881
 CANADA                    |   1997 | 483289766.711824
 CANADA                    |   1996 | 485181090.145316
 CANADA                    |   1995 |  485191453.77873
 CANADA                    |   1994 | 485575420.173312
 CANADA                    |   1993 | 487844849.944929
 CANADA                    |   1992 | 474253533.430136
 CHINA                     |   1998 |  272670405.02197
 CHINA                     |   1997 | 463838787.348842
 CHINA                     |   1996 | 465779318.708431
 CHINA                     |   1995 | 463882411.214515
 CHINA                     |   1994 | 462655907.743636
 CHINA                     |   1993 | 466904777.000644
 CHINA                     |   1992 | 462884545.457102
 EGYPT                     |   1998 | 269805181.794037
 EGYPT                     |   1997 | 462759222.728736
 EGYPT                     |   1996 | 466658142.080039
 EGYPT                     |   1995 | 465935956.375705
 EGYPT                     |   1994 | 455409987.054898
 EGYPT                     |   1993 | 476027550.792101
 EGYPT                     |   1992 | 466948096.575117
 ETHIOPIA                  |   1998 | 272677095.177908
 ETHIOPIA                  |   1997 | 463150894.405516
 ETHIOPIA                  |   1996 | 451444587.214328
 ETHIOPIA                  |   1995 |  465056832.37369
 ETHIOPIA                  |   1994 | 462458764.234794
 ETHIOPIA                  |   1993 | 457943470.030819
 ETHIOPIA                  |   1992 |  464093582.50487
 FRANCE                    |   1998 | 268189522.666275
 FRANCE                    |   1997 | 463880411.618751
 FRANCE                    |   1996 | 471206451.346803
 FRANCE                    |   1995 | 467175442.414751
 FRANCE                    |   1994 | 466669635.064376
 FRANCE                    |   1993 | 468753785.163474
 FRANCE                    |   1992 |  463536174.31393
 GERMANY                   |   1998 | 281786414.395814
 GERMANY                   |   1997 | 470302183.738792
 GERMANY                   |   1996 | 478625074.980818
 GERMANY                   |   1995 | 468777969.805316
 GERMANY                   |   1994 | 475112572.439691
 GERMANY                   |   1993 | 476904070.239258
 GERMANY                   |   1992 | 481083634.084906
 INDIA                     |   1998 | 276379881.390092
 INDIA                     |   1997 | 472509019.539972
 INDIA                     |   1996 | 472010038.428664
 INDIA                     |   1995 | 476573654.268431
 INDIA                     |   1994 | 475377125.767083
 INDIA                     |   1993 | 469752482.112073
 INDIA                     |   1992 | 468694764.761628
 INDONESIA                 |   1998 | 273343187.027358
 INDONESIA                 |   1997 | 454529752.129838
 INDONESIA                 |   1996 | 467318794.731989
 INDONESIA                 |   1995 | 467150876.543738
 INDONESIA                 |   1994 | 460886781.674256
 INDONESIA                 |   1993 | 472269748.925229
 INDONESIA                 |   1992 | 466639139.122014
 IRAN                      |   1998 |  271657298.55244
 IRAN                      |   1997 |  457050979.01551
 IRAN                      |   1996 | 458708627.642292
 IRAN                      |   1995 | 464024281.144768
 IRAN                      |   1994 |   462508070.5861
 IRAN                      |   1993 | 453930335.396161
 IRAN                      |   1992 | 454072808.587037
 IRAQ                      |   1998 | 278238952.854772
 IRAQ                      |   1997 | 474592660.896674
 IRAQ                      |   1996 | 467326829.027021
 IRAQ                      |   1995 | 468778161.817704
 IRAQ                      |   1994 | 475310454.730935
 IRAQ                      |   1993 | 466601916.927211
 IRAQ                      |   1992 | 468738203.351531
 JAPAN                     |   1998 | 267745229.110291
 JAPAN                     |   1997 | 463583282.824802
 JAPAN                     |   1996 |  460086375.22979
 JAPAN                     |   1995 | 467874023.443969
 JAPAN                     |   1994 | 462633879.866492
 JAPAN                     |   1993 |  466441065.05367
 JAPAN                     |   1992 | 465734523.323253
 JORDAN                    |   1998 | 264213647.283269
 JORDAN                    |   1997 | 457381745.517516
 JORDAN                    |   1996 | 458186094.427601
 JORDAN                    |   1995 | 456894100.505249
 JORDAN                    |   1994 | 455882561.199911
 JORDAN                    |   1993 | 453898326.495774
 JORDAN                    |   1992 | 459862324.574389
 KENYA                     |   1998 | 277398450.803042
 KENYA                     |   1997 | 473092183.715207
 KENYA                     |   1996 | 472224946.366946
 KENYA                     |   1995 | 469050638.887955
 KENYA                     |   1994 | 466785266.387348
 KENYA                     |   1993 | 463152509.640244
 KENYA                     |   1992 | 465783256.966085
 MOROCCO                   |   1998 | 276051660.342538
 MOROCCO                   |   1997 | 467207810.431239
 MOROCCO                   |   1996 | 469172623.950679
 MOROCCO                   |   1995 | 467306909.260571
 MOROCCO                   |   1994 | 469228042.196951
 MOROCCO                   |   1993 | 479989693.447604
 MOROCCO                   |   1992 | 463102075.900331
 MOZAMBIQUE                |   1998 |  273762891.86985
 MOZAMBIQUE                |   1997 |  461447863.11308
 MOZAMBIQUE                |   1996 | 463743956.915552
 MOZAMBIQUE                |   1995 | 464247623.019213
 MOZAMBIQUE                |   1994 | 460224010.280313
 MOZAMBIQUE                |   1993 | 459720328.601245
 MOZAMBIQUE                |   1992 | 462446745.205274
 PERU                      |   1998 | 276670284.655741
 PERU                      |   1997 | 476082284.020127
 PERU                      |   1996 | 466098015.167475
 PERU                      |   1995 |  468445061.18456
 PERU                      |   1994 | 461090730.690551
 PERU                      |   1993 | 472640260.937243
 PERU                      |   1992 | 473489106.816335
 ROMANIA                   |   1998 | 276137180.980702
 ROMANIA                   |   1997 |  465491192.24147
 ROMANIA                   |   1996 | 457480323.619991
 ROMANIA                   |   1995 | 468669677.882099
 ROMANIA                   |   1994 | 467992014.837174
 ROMANIA                   |   1993 | 465298976.208633
 ROMANIA                   |   1992 | 462159482.939836
 RUSSIA                    |   1998 | 284277197.805383
 RUSSIA                    |   1997 | 473265487.482454
 RUSSIA                    |   1996 | 484247797.482408
 RUSSIA                    |   1995 | 467832957.660538
 RUSSIA                    |   1994 | 476572744.369073
 RUSSIA                    |   1993 | 469711599.769509
 RUSSIA                    |   1992 | 469560916.225847
 SAUDI ARABIA              |   1998 | 273092092.658744
 SAUDI ARABIA              |   1997 | 466215718.679511
 SAUDI ARABIA              |   1996 | 470402488.447182
 SAUDI ARABIA              |   1995 | 467856322.037963
 SAUDI ARABIA              |   1994 |  469796409.16676
 SAUDI ARABIA              |   1993 | 469264871.662946
 SAUDI ARABIA              |   1992 | 469415691.616477
 UNITED KINGDOM            |   1998 | 276921010.283108
 UNITED KINGDOM            |   1997 | 468188946.210118
 UNITED KINGDOM            |   1996 | 475654204.830492
 UNITED KINGDOM            |   1995 | 471719038.483992
 UNITED KINGDOM            |   1994 | 465368062.078786
 UNITED KINGDOM            |   1993 | 476997626.028525
 UNITED KINGDOM            |   1992 | 458831537.650676
 UNITED STATES             |   1998 | 274615421.795389
 UNITED STATES             |   1997 | 467659287.486244
 UNITED STATES             |   1996 | 470027329.398397
 UNITED STATES             |   1995 | 464303506.112435
 UNITED STATES             |   1994 | 469302519.527081
 UNITED STATES             |   1993 | 464454991.144831
 UNITED STATES             |   1992 |  467657798.42511
 VIETNAM                   |   1998 | 266247076.932886
 VIETNAM                   |   1997 | 458340375.631059
 VIETNAM                   |   1996 | 463109039.127378
 VIETNAM                   |   1995 | 458654359.453831
 VIETNAM                   |   1994 | 464993715.724973
 VIETNAM                   |   1993 | 461114709.237285
 VIETNAM                   |   1992 | 457219203.494139
(175 rows)

COMMIT;
COMMIT

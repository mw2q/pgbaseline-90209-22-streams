BEGIN;
BEGIN
select
	nation,
	o_year,
	sum(amount) as sum_profit
from
	(
		select
			n_name as nation,
			extract(year from o_orderdate) as o_year,
			l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount
		from
			part,
			supplier,
			lineitem,
			partsupp,
			orders,
			nation
		where
			s_suppkey = l_suppkey
			and ps_suppkey = l_suppkey
			and ps_partkey = l_partkey
			and p_partkey = l_partkey
			and o_orderkey = l_orderkey
			and s_nationkey = n_nationkey
			and p_name like '%salmon%'
	) as profit
group by
	nation,
	o_year
order by
	nation,
	o_year desc;
          nation           | o_year |    sum_profit    
---------------------------+--------+------------------
 ALGERIA                   |   1998 | 271064289.362076
 ALGERIA                   |   1997 | 457846853.944786
 ALGERIA                   |   1996 | 464126121.411062
 ALGERIA                   |   1995 |  461171151.36282
 ALGERIA                   |   1994 | 458745468.484383
 ALGERIA                   |   1993 | 457171582.143404
 ALGERIA                   |   1992 | 456134083.793841
 ARGENTINA                 |   1998 | 270384355.990226
 ARGENTINA                 |   1997 | 454469004.912515
 ARGENTINA                 |   1996 | 462604906.301327
 ARGENTINA                 |   1995 | 461844650.458893
 ARGENTINA                 |   1994 | 467072128.216753
 ARGENTINA                 |   1993 | 455610213.326144
 ARGENTINA                 |   1992 | 462886537.923443
 BRAZIL                    |   1998 | 268008737.223393
 BRAZIL                    |   1997 | 457613681.601881
 BRAZIL                    |   1996 | 457216786.883432
 BRAZIL                    |   1995 | 472557579.222665
 BRAZIL                    |   1994 | 459361336.328169
 BRAZIL                    |   1993 | 457820781.674457
 BRAZIL                    |   1992 | 464474923.595244
 CANADA                    |   1998 | 280197128.468787
 CANADA                    |   1997 | 470550749.207853
 CANADA                    |   1996 | 476256857.138105
 CANADA                    |   1995 | 473525287.160529
 CANADA                    |   1994 | 474059898.591345
 CANADA                    |   1993 | 478623661.514496
 CANADA                    |   1992 | 474105511.745921
 CHINA                     |   1998 | 274094942.540981
 CHINA                     |   1997 | 464970423.399317
 CHINA                     |   1996 | 466776464.684272
 CHINA                     |   1995 | 460942133.322606
 CHINA                     |   1994 | 473049757.691479
 CHINA                     |   1993 | 467054367.043321
 CHINA                     |   1992 |  464349446.55487
 EGYPT                     |   1998 | 281311333.295775
 EGYPT                     |   1997 | 473749511.932025
 EGYPT                     |   1996 | 473720708.093995
 EGYPT                     |   1995 | 469470995.459176
 EGYPT                     |   1994 |  468708131.34536
 EGYPT                     |   1993 | 476304074.295656
 EGYPT                     |   1992 | 469077467.688531
 ETHIOPIA                  |   1998 | 262451793.548139
 ETHIOPIA                  |   1997 | 446029736.798883
 ETHIOPIA                  |   1996 | 448227776.747474
 ETHIOPIA                  |   1995 | 446206983.751722
 ETHIOPIA                  |   1994 | 443914163.899792
 ETHIOPIA                  |   1993 | 447272263.653269
 ETHIOPIA                  |   1992 | 448259549.970757
 FRANCE                    |   1998 |  267795663.86471
 FRANCE                    |   1997 | 460141785.730261
 FRANCE                    |   1996 | 462597835.220731
 FRANCE                    |   1995 | 455412391.121276
 FRANCE                    |   1994 | 461965436.869417
 FRANCE                    |   1993 | 462038944.829087
 FRANCE                    |   1992 | 459688163.902288
 GERMANY                   |   1998 | 273424498.225372
 GERMANY                   |   1997 | 477209159.160818
 GERMANY                   |   1996 | 480685294.680631
 GERMANY                   |   1995 | 472501958.192251
 GERMANY                   |   1994 | 480000108.829114
 GERMANY                   |   1993 | 476684926.920367
 GERMANY                   |   1992 | 480361020.761223
 INDIA                     |   1998 | 267698637.647997
 INDIA                     |   1997 | 474083792.028779
 INDIA                     |   1996 | 471795892.598493
 INDIA                     |   1995 | 471585629.795094
 INDIA                     |   1994 | 464713784.351062
 INDIA                     |   1993 | 473697752.545979
 INDIA                     |   1992 | 478041694.479961
 INDONESIA                 |   1998 | 269886741.255585
 INDONESIA                 |   1997 | 464252267.508014
 INDONESIA                 |   1996 | 462098716.731554
 INDONESIA                 |   1995 | 456712918.345087
 INDONESIA                 |   1994 | 456224183.231877
 INDONESIA                 |   1993 | 463791915.132244
 INDONESIA                 |   1992 |  464017581.39936
 IRAN                      |   1998 | 270378195.260354
 IRAN                      |   1997 | 468384841.590812
 IRAN                      |   1996 |  457630073.33456
 IRAN                      |   1995 | 462863062.865948
 IRAN                      |   1994 |  458918380.48151
 IRAN                      |   1993 |  465200894.60208
 IRAN                      |   1992 | 464562571.419689
 IRAQ                      |   1998 | 278729207.823421
 IRAQ                      |   1997 | 468058417.720601
 IRAQ                      |   1996 | 480786861.456067
 IRAQ                      |   1995 | 475851424.512148
 IRAQ                      |   1994 | 479112023.138161
 IRAQ                      |   1993 | 478065646.440303
 IRAQ                      |   1992 |  466124538.11297
 JAPAN                     |   1998 | 265876121.589841
 JAPAN                     |   1997 | 467032680.805293
 JAPAN                     |   1996 | 470981558.313613
 JAPAN                     |   1995 | 465861513.732856
 JAPAN                     |   1994 | 455981713.273254
 JAPAN                     |   1993 | 464691062.553088
 JAPAN                     |   1992 | 461488182.951223
 JORDAN                    |   1998 | 268155223.233139
 JORDAN                    |   1997 | 454659859.576212
 JORDAN                    |   1996 | 454781727.192554
 JORDAN                    |   1995 | 459455132.718743
 JORDAN                    |   1994 | 455833644.916563
 JORDAN                    |   1993 | 452533789.275305
 JORDAN                    |   1992 | 457554802.875036
 KENYA                     |   1998 | 269600140.938675
 KENYA                     |   1997 | 472421571.631472
 KENYA                     |   1996 | 462318786.590008
 KENYA                     |   1995 | 473135762.206891
 KENYA                     |   1994 |  469910960.76847
 KENYA                     |   1993 | 467144776.036099
 KENYA                     |   1992 | 465632806.437932
 MOROCCO                   |   1998 | 270563862.009431
 MOROCCO                   |   1997 | 463218735.768927
 MOROCCO                   |   1996 | 467011018.534775
 MOROCCO                   |   1995 | 466029278.946068
 MOROCCO                   |   1994 | 470384093.316221
 MOROCCO                   |   1993 | 463931370.056482
 MOROCCO                   |   1992 | 464366331.504764
 MOZAMBIQUE                |   1998 | 274463282.720465
 MOZAMBIQUE                |   1997 |  464043746.06871
 MOZAMBIQUE                |   1996 | 465446445.088511
 MOZAMBIQUE                |   1995 | 457340860.372119
 MOZAMBIQUE                |   1994 | 456926369.535873
 MOZAMBIQUE                |   1993 | 463788692.671282
 MOZAMBIQUE                |   1992 | 459504633.955173
 PERU                      |   1998 | 267437638.024357
 PERU                      |   1997 | 463605889.754762
 PERU                      |   1996 | 458698158.461518
 PERU                      |   1995 | 460154933.430181
 PERU                      |   1994 | 454516137.639379
 PERU                      |   1993 | 459615966.946193
 PERU                      |   1992 | 457041144.929276
 ROMANIA                   |   1998 | 273874470.838111
 ROMANIA                   |   1997 | 463045703.681906
 ROMANIA                   |   1996 | 472036601.533418
 ROMANIA                   |   1995 | 463676800.329899
 ROMANIA                   |   1994 | 462020530.634176
 ROMANIA                   |   1993 | 462525172.764674
 ROMANIA                   |   1992 |  459113167.07077
 RUSSIA                    |   1998 | 279718528.556354
 RUSSIA                    |   1997 | 467318025.505425
 RUSSIA                    |   1996 | 473266709.498803
 RUSSIA                    |   1995 | 470358377.684614
 RUSSIA                    |   1994 | 472095678.683125
 RUSSIA                    |   1993 | 470649415.999668
 RUSSIA                    |   1992 | 475749943.197784
 SAUDI ARABIA              |   1998 | 275146087.201126
 SAUDI ARABIA              |   1997 |   457904198.3795
 SAUDI ARABIA              |   1996 | 459329857.902245
 SAUDI ARABIA              |   1995 | 454832046.810525
 SAUDI ARABIA              |   1994 |  459138505.79637
 SAUDI ARABIA              |   1993 |  464326038.36849
 SAUDI ARABIA              |   1992 | 466471465.055053
 UNITED KINGDOM            |   1998 | 262696537.109048
 UNITED KINGDOM            |   1997 | 456219659.688154
 UNITED KINGDOM            |   1996 | 458697263.996812
 UNITED KINGDOM            |   1995 | 459317066.238284
 UNITED KINGDOM            |   1994 | 446955011.566581
 UNITED KINGDOM            |   1993 | 457520762.265878
 UNITED KINGDOM            |   1992 | 452664968.636871
 UNITED STATES             |   1998 | 279741839.271263
 UNITED STATES             |   1997 | 471992943.295846
 UNITED STATES             |   1996 |  471355964.15486
 UNITED STATES             |   1995 | 467362141.143319
 UNITED STATES             |   1994 | 472903788.978242
 UNITED STATES             |   1993 | 474465502.665515
 UNITED STATES             |   1992 | 464819178.125674
 VIETNAM                   |   1998 | 266252932.383586
 VIETNAM                   |   1997 | 463376960.009661
 VIETNAM                   |   1996 | 464779337.363724
 VIETNAM                   |   1995 | 465094541.072539
 VIETNAM                   |   1994 | 470378833.463731
 VIETNAM                   |   1993 | 469457330.698432
 VIETNAM                   |   1992 | 471981997.881411
(175 rows)

COMMIT;
COMMIT

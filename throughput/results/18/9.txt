BEGIN;
BEGIN
select
	nation,
	o_year,
	sum(amount) as sum_profit
from
	(
		select
			n_name as nation,
			extract(year from o_orderdate) as o_year,
			l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount
		from
			part,
			supplier,
			lineitem,
			partsupp,
			orders,
			nation
		where
			s_suppkey = l_suppkey
			and ps_suppkey = l_suppkey
			and ps_partkey = l_partkey
			and p_partkey = l_partkey
			and o_orderkey = l_orderkey
			and s_nationkey = n_nationkey
			and p_name like '%goldenrod%'
	) as profit
group by
	nation,
	o_year
order by
	nation,
	o_year desc;
          nation           | o_year |    sum_profit    
---------------------------+--------+------------------
 ALGERIA                   |   1998 |  265388427.00715
 ALGERIA                   |   1997 | 455135428.794427
 ALGERIA                   |   1996 | 456553377.814853
 ALGERIA                   |   1995 | 456374279.262868
 ALGERIA                   |   1994 | 451735343.185328
 ALGERIA                   |   1993 | 455543370.334265
 ALGERIA                   |   1992 | 448801341.147755
 ARGENTINA                 |   1998 | 269913033.737428
 ARGENTINA                 |   1997 | 461643244.468757
 ARGENTINA                 |   1996 | 466521079.416745
 ARGENTINA                 |   1995 | 468366632.566803
 ARGENTINA                 |   1994 |  465536374.64221
 ARGENTINA                 |   1993 | 462160238.437243
 ARGENTINA                 |   1992 | 464229636.404674
 BRAZIL                    |   1998 | 274730323.986147
 BRAZIL                    |   1997 | 467248231.072538
 BRAZIL                    |   1996 | 475219450.346547
 BRAZIL                    |   1995 | 465038972.430237
 BRAZIL                    |   1994 |  467204117.16016
 BRAZIL                    |   1993 | 469404405.811484
 BRAZIL                    |   1992 | 472438573.198428
 CANADA                    |   1998 | 267762645.638818
 CANADA                    |   1997 | 468420822.278344
 CANADA                    |   1996 | 475153439.241145
 CANADA                    |   1995 | 464765946.875305
 CANADA                    |   1994 | 472583319.573287
 CANADA                    |   1993 | 470321750.108792
 CANADA                    |   1992 | 460767679.425218
 CHINA                     |   1998 | 274484985.121581
 CHINA                     |   1997 | 460904854.079047
 CHINA                     |   1996 | 463049652.536887
 CHINA                     |   1995 | 461595650.716434
 CHINA                     |   1994 |  463665710.10344
 CHINA                     |   1993 | 457149695.328715
 CHINA                     |   1992 | 464792710.090117
 EGYPT                     |   1998 | 266680603.332852
 EGYPT                     |   1997 | 464091075.618386
 EGYPT                     |   1996 | 460128587.657788
 EGYPT                     |   1995 | 454314453.605168
 EGYPT                     |   1994 | 453013316.341653
 EGYPT                     |   1993 | 461510338.265009
 EGYPT                     |   1992 | 452962056.990191
 ETHIOPIA                  |   1998 | 264673565.870789
 ETHIOPIA                  |   1997 | 447287965.391764
 ETHIOPIA                  |   1996 | 458202635.638328
 ETHIOPIA                  |   1995 | 450606572.254632
 ETHIOPIA                  |   1994 | 456615042.215797
 ETHIOPIA                  |   1993 | 459197297.637918
 ETHIOPIA                  |   1992 |  461684582.82338
 FRANCE                    |   1998 | 270241874.376135
 FRANCE                    |   1997 | 455066662.881005
 FRANCE                    |   1996 | 461177419.129103
 FRANCE                    |   1995 | 451723647.253984
 FRANCE                    |   1994 | 456791088.603884
 FRANCE                    |   1993 | 455963912.860552
 FRANCE                    |   1992 | 457456086.776948
 GERMANY                   |   1998 | 275827835.250709
 GERMANY                   |   1997 | 468491405.945177
 GERMANY                   |   1996 | 473292719.226985
 GERMANY                   |   1995 | 469041692.940242
 GERMANY                   |   1994 | 474073483.904506
 GERMANY                   |   1993 | 481214342.396428
 GERMANY                   |   1992 | 473266296.957173
 INDIA                     |   1998 |  269842415.26451
 INDIA                     |   1997 | 466862251.723426
 INDIA                     |   1996 | 465835378.433562
 INDIA                     |   1995 | 471124109.782764
 INDIA                     |   1994 | 466150965.489656
 INDIA                     |   1993 |  471272411.55415
 INDIA                     |   1992 |  468576090.15419
 INDONESIA                 |   1998 | 269820307.629814
 INDONESIA                 |   1997 | 454118540.192352
 INDONESIA                 |   1996 | 455946336.116215
 INDONESIA                 |   1995 | 453850156.020488
 INDONESIA                 |   1994 |  452120391.83979
 INDONESIA                 |   1993 | 457037911.247195
 INDONESIA                 |   1992 | 462440315.420011
 IRAN                      |   1998 | 275149458.456129
 IRAN                      |   1997 | 469652061.017626
 IRAN                      |   1996 | 471817531.812973
 IRAN                      |   1995 | 468545000.734684
 IRAN                      |   1994 |  464642806.83228
 IRAN                      |   1993 | 465997144.551886
 IRAN                      |   1992 | 469355645.910296
 IRAQ                      |   1998 | 276336664.231873
 IRAQ                      |   1997 | 471124168.023317
 IRAQ                      |   1996 | 485880447.577805
 IRAQ                      |   1995 | 469154891.717015
 IRAQ                      |   1994 | 475384374.760371
 IRAQ                      |   1993 | 477031577.136381
 IRAQ                      |   1992 | 479543718.271795
 JAPAN                     |   1998 | 272279022.114936
 JAPAN                     |   1997 | 466688569.622682
 JAPAN                     |   1996 | 460541040.697428
 JAPAN                     |   1995 | 460816923.736971
 JAPAN                     |   1994 | 462614312.114751
 JAPAN                     |   1993 | 467213374.812851
 JAPAN                     |   1992 | 453647308.068054
 JORDAN                    |   1998 | 268394360.840432
 JORDAN                    |   1997 | 444100513.346127
 JORDAN                    |   1996 |  449673502.59561
 JORDAN                    |   1995 | 443598145.472184
 JORDAN                    |   1994 | 458673057.765239
 JORDAN                    |   1993 | 459145876.402453
 JORDAN                    |   1992 | 448664856.306554
 KENYA                     |   1998 | 272484339.239654
 KENYA                     |   1997 | 467509543.355462
 KENYA                     |   1996 | 466996874.451131
 KENYA                     |   1995 | 467194487.100173
 KENYA                     |   1994 | 470928035.756875
 KENYA                     |   1993 | 474955636.378602
 KENYA                     |   1992 |   474106168.7292
 MOROCCO                   |   1998 |  272884389.94967
 MOROCCO                   |   1997 | 461653589.072116
 MOROCCO                   |   1996 | 470480064.670564
 MOROCCO                   |   1995 | 466812585.865015
 MOROCCO                   |   1994 | 464257917.090402
 MOROCCO                   |   1993 | 467426771.616921
 MOROCCO                   |   1992 |  463455542.12676
 MOZAMBIQUE                |   1998 |  270536421.32141
 MOZAMBIQUE                |   1997 | 452345649.717434
 MOZAMBIQUE                |   1996 | 450366831.920955
 MOZAMBIQUE                |   1995 | 457564678.774659
 MOZAMBIQUE                |   1994 | 460693894.532262
 MOZAMBIQUE                |   1993 | 455210015.121358
 MOZAMBIQUE                |   1992 | 457411684.657232
 PERU                      |   1998 | 276287509.798635
 PERU                      |   1997 | 457866511.702022
 PERU                      |   1996 | 462928852.925129
 PERU                      |   1995 | 466475281.898405
 PERU                      |   1994 | 455940246.007513
 PERU                      |   1993 | 462459650.827544
 PERU                      |   1992 | 469404360.752854
 ROMANIA                   |   1998 | 274922265.397328
 ROMANIA                   |   1997 | 459884268.745307
 ROMANIA                   |   1996 | 464919322.690825
 ROMANIA                   |   1995 | 449056826.994121
 ROMANIA                   |   1994 | 457250439.839302
 ROMANIA                   |   1993 | 462676454.333879
 ROMANIA                   |   1992 | 472592293.073081
 RUSSIA                    |   1998 | 270925347.348732
 RUSSIA                    |   1997 | 460758683.641687
 RUSSIA                    |   1996 | 465133391.872926
 RUSSIA                    |   1995 | 462749573.058949
 RUSSIA                    |   1994 | 451390513.161156
 RUSSIA                    |   1993 | 460092611.385018
 RUSSIA                    |   1992 | 471354235.237613
 SAUDI ARABIA              |   1998 |  272876744.87761
 SAUDI ARABIA              |   1997 | 463813968.838983
 SAUDI ARABIA              |   1996 | 461180396.988263
 SAUDI ARABIA              |   1995 | 465008433.674223
 SAUDI ARABIA              |   1994 | 464277046.240789
 SAUDI ARABIA              |   1993 | 457818319.414631
 SAUDI ARABIA              |   1992 | 457394636.371757
 UNITED KINGDOM            |   1998 | 267023827.282606
 UNITED KINGDOM            |   1997 | 462483859.856798
 UNITED KINGDOM            |   1996 | 458862982.912844
 UNITED KINGDOM            |   1995 | 454456014.160597
 UNITED KINGDOM            |   1994 | 463695858.386919
 UNITED KINGDOM            |   1993 | 466194247.357369
 UNITED KINGDOM            |   1992 | 459762233.858889
 UNITED STATES             |   1998 | 272146765.807474
 UNITED STATES             |   1997 | 475281267.135892
 UNITED STATES             |   1996 | 470462125.164457
 UNITED STATES             |   1995 | 469781414.894318
 UNITED STATES             |   1994 | 472875758.524327
 UNITED STATES             |   1993 | 464172888.625977
 UNITED STATES             |   1992 | 470208973.396709
 VIETNAM                   |   1998 | 271513873.129559
 VIETNAM                   |   1997 | 463291331.414932
 VIETNAM                   |   1996 |  472146337.43874
 VIETNAM                   |   1995 | 461168915.492146
 VIETNAM                   |   1994 | 466380509.604473
 VIETNAM                   |   1993 | 470135441.002997
 VIETNAM                   |   1992 | 466846890.310818
(175 rows)

COMMIT;
COMMIT
